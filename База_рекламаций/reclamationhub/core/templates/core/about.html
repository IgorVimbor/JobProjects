<!-- –®–∞–±–ª–æ–Ω —Å—Ç—Ä–∞–Ω–∏—Ü—ã "–û –ø—Ä–æ–µ–∫—Ç–µ" -->

<!-- core\templates\core\about.html -->

{% extends 'base.html' %}

{% block title %}–û –ø—Ä–æ–µ–∫—Ç–µ{% endblock %}

{% block content %}

<!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
<div class="about-header">
    <div class="d-flex align-items-center justify-content-between flex-wrap">
        <div class="d-flex align-items-center">
            <h2 class="mb-3">{{ project.name }}</h2>
        </div>
    </div>
</div>

<!-- –û–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∏ –∫–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ -->
<div class="row mb-3">
    <div class="col-lg-6 mb-4 mb-lg-0">
        <div class="card h-100">
            <div class="card-header" style="background-color: #417690; color: white;">
                <h5 class="mb-0">üìä –û —Å–∏—Å—Ç–µ–º–µ</h5>
            </div>
            <div class="card-body">
                <p class="card-text small">{{ project.description }}</p>
                <hr>
                <table class="info-table w-100 small">
                    <tr>
                        <td>–í–µ—Ä—Å–∏—è</td>
                        <td>{{ project.version }} {{ project.release_date }}</td>
                    </tr>
                    <tr>
                        <td>–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫</td>
                        <td><strong>{{ project.author }}</strong></td>
                    </tr>
                    <tr>
                        <td>Email</td>
                        <td><a href="mailto:{{ project.email }}">{{ project.email }}</a></td>
                    </tr>
                    <tr>
                        <td>–ì–æ–¥ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Å—Ä–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∫–∏</td>
                        <td><strong>{{ project.year_started }} ‚Äî {% now "Y" %}</strong></td>
                    </tr>
                    <tr>
                        <td>–õ–∏—Ü–µ–Ω–∑–∏—è</td>
                        <td>{{ project.license }}</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>

    <!-- –û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ -->
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header" style="background-color: #417690; color: white;">
                <h5 class="mb-0">
                    üìä –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è
                    <small class="opacity-75 ms-2">{{ project.version }} {{ project.release_date }}</small>
                </h5>
            </div>
            <div class="card-body">
                <h6 class="text-muted mb-2"><strong>–ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ:</strong></h6>
                <div class="row small">
                    {% for item in whats_new %}
                    <p class="mb-1">
                        <span class="text-success me-2">‚úì</span>{{ item }}
                    </p>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –ö–∞—Ä—Ç–∞ —Å–∞–π—Ç–∞ -->
<div class="card mb-3">
    <div class="card-header" style="background-color: #17a2b8; color: white;">
        <h5 class="mb-0">üó∫Ô∏è –ö–∞—Ä—Ç–∞ —Å–∞–π—Ç–∞</h5>
    </div>
    <div class="card-body">

        <!-- –°—Ç—Ä–æ–∫–∞ 1: –ì–ª–∞–≤–Ω–∞—è, –†–µ–∫–ª–∞–º–∞—Ü–∏–∏, –ê–∫—Ç—ã, –ü—Ä–µ—Ç–µ–Ω–∑–∏–∏ (4 –∫–æ–ª–æ–Ω–∫–∏) -->
        <div class="row mb-3">
            {% for item in sitemap.row1 %}
            <div class="col-sm-6 col-lg-3 mb-3 mb-lg-0">
                {% include 'core/sitemap_item.html' %}
            </div>
            {% endfor %}
        </div>

        <hr class="my-2">

        <!-- –°—Ç—Ä–æ–∫–∞ 2: –°–ø—Ä–∞–≤–∫–∏, –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä–µ–∫–ª–∞–º–∞—Ü–∏–π, –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø—Ä–µ—Ç–µ–Ω–∑–∏–π (3 –∫–æ–ª–æ–Ω–∫–∏) -->
        <div class="row mb-3">
            {% for item in sitemap.row2 %}
            <div class="col-md-4 mb-3 mb-md-0">
                {% include 'core/sitemap_item.html' %}
            </div>
            {% endfor %}
        </div>

        <hr class="my-2">

        <!-- –°—Ç—Ä–æ–∫–∞ 3: –≠–∫—Å–ø–æ—Ä—Ç, –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ (2 –∫–æ–ª–æ–Ω–∫–∏) -->
        <div class="row">
            {% for item in sitemap.row3 %}
            <div class="col-md-6 mb-3 mb-md-0">
                {% include 'core/sitemap_item.html' %}
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ (—Å–≤–æ—Ä–∞—á–∏–≤–∞–µ–º–∞—è) -->
<div class="card mb-3">
    <div class="card-header card-header-collapsible d-flex align-items-center"
         style="background-color: #17a2b8; color: white;"
         data-bs-toggle="collapse"
         data-bs-target="#collapseTechnologies">
        <h5 class="mb-0">üìä –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</h5>
        <span class="collapse-icon ms-2">‚ñº</span>
    </div>
    <div class="collapse" id="collapseTechnologies">
        <ul class="list-group list-group-flush small">
            {% for tech in technologies %}
            <li class="list-group-item d-flex justify-content-between align-items-center py-1">
                <div>
                    {{ tech.name }}
                    {% if tech.version %}
                    <span class="text-muted">{{ tech.version }}</span>
                    {% endif %}
                </div>
                <span class="text-muted">{{ tech.purpose }}</span>
            </li>
            {% endfor %}
        </ul>
    </div>
</div>

<!-- –ü—Ä–µ–¥—ã–¥—É—â–∏–µ –≤–µ—Ä—Å–∏–∏ (—Å–≤–æ—Ä–∞—á–∏–≤–∞–µ–º–∞—è) -->
<div class="card mb-3">
    <div class="card-header card-header-collapsible d-flex align-items-center"
         style="background-color: #17a2b8; color: white;"
         data-bs-toggle="collapse"
         data-bs-target="#collapseChangelog">
        <h5 class="mb-0">üìú –ü—Ä–µ–¥—ã–¥—É—â–∏–µ –≤–µ—Ä—Å–∏–∏</h5>
        <span class="collapse-icon ms-2">‚ñº</span>
    </div>
    <div class="collapse" id="collapseChangelog">
        <div class="card-body py-2">
            <!-- –¶–∏–∫–ª–æ–º –ø–æ –≤—Å–µ–º –≤–µ—Ä—Å–∏—è–º –∏–∑ CHANGELOG -->
            {% for release in changelog %}
            <div class="version-item">
                <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –≤–µ—Ä—Å–∏–∏ -->
                <div class="version-header collapsed d-flex justify-content-between align-items-center"
                     data-bs-toggle="collapse"
                     data-bs-target="#version-{{ forloop.counter }}">
                    <div>
                        <small class="collapse-icon me-2">‚ñº</small>
                        <small class="text-primary">v{{ release.version }}</small>
                        <small class="text-muted ms-2">‚Äî {{ release.title }}</small>
                    </div>
                    <small class="text-muted">{{ release.date }}</small>
                </div>

                <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–µ—Ä—Å–∏–∏ (4 –∫–æ–ª–æ–Ω–∫–∏ –ø–æ —Ç–∏–ø–∞–º –∏–∑–º–µ–Ω–µ–Ω–∏–π) -->
                <div class="collapse" id="version-{{ forloop.counter }}">
                    <div class="version-body">
                        <div class="row small">
                            {% for group in release.changes_grouped %}
                            <div class="col-md-6 col-lg-3 mb-2 mb-lg-0">
                                <div class="change-group-title text-{{ group.color }} ps-4">
                                    <strong>{{ group.label }}</strong>  <!-- –¢–∏–ø –∏–∑–º–µ–Ω–µ–Ω–∏—è (–î–æ–±–∞–≤–ª–µ–Ω–æ, –ò–∑–º–µ–Ω–µ–Ω–æ, –£–¥–∞–ª–µ–Ω–æ)-->
                                </div>
                                <hr class="my-1"> <!-- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è -->
                                {% for item in group.items %}
                                <div class="change-group-item ps-4">
                                    <small>{{ item }}</small> <!-- –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è -->
                                </div>
                                {% endfor %}
                            </div>
                            {% empty %}
                            <div class="col-12 text-muted">–ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π</div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <hr class="my-1"> <!-- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è -->
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
<div class="row mt-3 mb-4">
    <div class="col-12">
        <div class="d-flex gap-2 justify-content-center flex-wrap">
            <a href="{% url 'home' %}" class="btn btn-primary me-2">
                üîÑ –ù–∞ –≥–ª–∞–≤–Ω—É—é
            </a>
            <button class="btn btn-outline-secondary" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
                ‚¨ÜÔ∏è –í–≤–µ—Ä—Ö
            </button>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–µ–ª–∫–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ collapse-—ç–ª–µ–º–µ–Ω—Ç–∞
    function initCollapseIcon(collapseEl) {
        const trigger = document.querySelector('[data-bs-target="#' + collapseEl.id + '"]');

        if (!trigger) return;

        const icon = trigger.querySelector('.collapse-icon');
        if (!icon) return;

        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        if (collapseEl.classList.contains('show')) {
            icon.style.transform = 'rotate(0deg)';
        } else {
            icon.style.transform = 'rotate(-90deg)';
        }

        // –ü—Ä–∏ —Ä–∞—Å–∫—Ä—ã—Ç–∏–∏
        collapseEl.addEventListener('show.bs.collapse', function(event) {
            if (event.target === collapseEl) {
                icon.style.transform = 'rotate(0deg)';
            }
        });

        // –ü—Ä–∏ —Å–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–∏
        collapseEl.addEventListener('hide.bs.collapse', function(event) {
            if (event.target === collapseEl) {
                icon.style.transform = 'rotate(-90deg)';
            }
        });
    }

    // –ê–≤—Ç–æ—Å–∫—Ä–æ–ª–ª –∫ –Ω–∏–∑—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∏
    function initAutoScroll(collapseEl) {
        collapseEl.addEventListener('shown.bs.collapse', function(event) {
            // –¢–æ–ª—å–∫–æ –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫ (–Ω–µ –¥–ª—è –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤–µ—Ä—Å–∏–π)
            if (event.target === collapseEl &&
                (collapseEl.id === 'collapseTechnologies' || collapseEl.id === 'collapseChangelog')) {

                // –°–∫—Ä–æ–ª–ª —á—Ç–æ–±—ã –∫–∞—Ä—Ç–æ—á–∫–∞ –±—ã–ª–∞ –≤–∏–¥–Ω–∞ —Ü–µ–ª–∏–∫–æ–º
                window.scrollTo({
                    top: document.body.scrollHeight,
                    behavior: 'smooth'
                });
            }
        });
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤—Å–µ collapse-—ç–ª–µ–º–µ–Ω—Ç—ã
    const collapseElements = document.querySelectorAll('.collapse');
    collapseElements.forEach(function(collapseEl) {
        initCollapseIcon(collapseEl);
        initAutoScroll(collapseEl);
    });
});
</script>
{% endblock %}